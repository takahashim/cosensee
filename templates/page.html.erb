<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <meta name="referrer" content="same-origin"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0"/>
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible"/>
    <meta name="format-detection" content="email=no,telephone=no,address=no,date=no"/>
    <title><%= title %> | <%= project.name%></title>
    <link href="./styles/tailwind.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.18/dist/katex.min.css" integrity="sha384-veTAhWILPOotXm+kbR5uY7dRamYLJf58I7P+hJhjeuc7hsMAkJHTsPahAl0hBST0" crossorigin="anonymous">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.18/dist/katex.min.js" integrity="sha384-v6mkHYHfY/4BWq54f7lQAdtIsoZZIByznQ3ZqN38OL4KCsrxo31SLlPiak7cj/Mg" crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.18/dist/contrib/auto-render.min.js" integrity="sha384-hCXGrW6PitJEwbkoStFjeJxv+fSOOQKOPbJxSfM6G5sWZjAyWhXiTIIAmQqnlLlh" crossorigin="anonymous"></script>

    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,600,600i,700,700i|Roboto:400,400i,500,500i,700,700i"/>
    <style>
      p.pagetitle {
          display: -webkit-box;
          -webkit-line-clamp: 3;
          -webkit-box-orient: vertical;
      }
    </style>
    <% if page&.song_page? %>
    <style>@media print { img.lyrics { display: none !important; } }</style>
    <% end %>
  </head>
  <body class="bg-slate-100">
    <div class="max-w-screen-lg mx-auto p-4">
      <nav class="my-4 font-extralight text-2xl">
        <span id="project-name"><a href="/"><%= project.name %></a></span>
      </nav>
      <div class="max-w-screen bg-white p-4">
        <h1 class="text-3xl mb-8"><%= title %></h1>
        <div class="leading-7">
          <%== page&.to_html(project:) %>
        </div>
      </div>

      <div class="grid grid-cols-6 gap-2 py-8">
        <div class="bg-blue-400 shadow-md rounded-md aspect-square flex items-center justify-center p-2 overflow-hidden">
          <div class="text-lg text-center text-gray-100">
            Links<br>ðŸ”—
          </div>
        </div>
        <% project.page_store.find_link_pages_by_title(title).each do |page|%>
        <div class="bg-white shadow-md rounded-md aspect-square flex items-start justify-center p-2 overflow-hidden">
          <div class="break-words text-xs w-full">
            <a href="<%= page.link_path %>">
              <p class="pagetitle font-bold  overflow-hidden"><%= page.title %></p>
            </a>
            <a href="<%= page.link_path %>">
              <p class="inline text-xs"><%== page.summary %></p>
            </a>
          </div>
        </div>
        <% end %>
      </div>
    </div>
  </body>
  <script>
  document.addEventListener('keydown', function(event) {
    if (window.location.hostname === 'localhost' && event.key === 'o' && event.ctrlKey) {
      event.preventDefault();
      const projectName = document.querySelector('#project-name');
      if (projectName) {
        const currentPath = window.location.pathname.replace('.html', '');
        const newUrl = `https://scrapbox.io/${projectName.textContent}${currentPath}`;
        window.open(newUrl, 'scrapbox');
      }
    }
  });
  </script>
</html>
